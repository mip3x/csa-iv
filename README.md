# csa-lab-iv
4-ая лабораторная работа в рамках дисциплины "Архитектура компьютерных систем"

`Вариант`: `forth | cisc | harv | hw | tick | binary | trap | port | pstr | prob1 | vector`

## Язык программирования

### Синтаксис

Форма Бэкуса-Науэра:

```ebnf
<program> ::= <definitions> <body>

<definitions> ::= <definition>*

<definition> ::= ":" <ident> <body> ";"

<body> ::= <statement>*

<statement> ::= <number>
            | <string>
            | <ident>
            | <declaration>
            | <if_stmt>
            | <loop_stmt>
            | <trap_block>
            | <require>

<declaration> ::= "var" <ident> (<number>)?
            | "str" <ident> (<string>)?
            | "port" <ident> <number>
            | "vector" <number> ":" <ident_list>

<if_stmt> ::= "if" <body> ("else" <body>)? "then"

<loop_stmt> ::= "begin" <body> "until"
            | <number> "times" <body> "next"

<trap_block> ::= "trap" <ident> <body> "endtrap"

<require> ::= "#require" <string>

<ident_list> ::= <ident> ("," <ident>)*

<number> ::= <decimal> | <hexadecimal>

<decimal> ::= <digit>+                           

<hexadecimal> ::= "0x" <hex_digit>+                  

<ident> ::= <letter> (<letter> | <digit> | "_")*

<string> ::= [^"]

<letter> ::= [a-zA-Z]
<digit> ::= [0-9]
<hex_digit> ::= <digit> | [a-fA-F]
```

### Описание ...

При упоминании стека имеется ввиду всегда `стек данных`, если не указано иное.

#### Операции по работе с данными

- **Загрузка числа на стек**
    - **Синтаксис**: `<number>`
    - **Описание**: загрузить на стек число `<number>`
    - **Операция**: `dataStack.push(<number>)`

- **Загрузка адреса переменной на стек**
    - **Синтаксис**: `<var>`
    - **Описание**: загрузить на стек адрес переменной `<var>`
    - **Операция**: `dataStack.push(addrof(<var>))`

- **Сохранение значения по адресу**
    - **Синтаксис**: `!`
    - **Описание**: по адресу значения первого элемента стека сохранить значение второго элемента стека
    - **Операция**: `M[dataStack.pop()] = dataStack.pop()`

- **Загрузка значения по адресу**
    - **Синтаксис**: `@`
    - **Описание**: загрузить на стек значение по адресу значения первого элемента стека
    - **Операция**: `dataStack.push(M[dataStack.pop()])`

#### Арифметические операции

- **Сложение**
    - **Синтаксис**: `+`
    - **Описание**: сложить первое и второе значение со стека и положить результат обратно на стек
    - **Операция**: `dataStack.push(dataStack.pop() + dataStack.pop())`

- **Вычитание**
    - **Синтаксис**: `-`
    - **Описание**: вычесть первое значение на стеке из второго и положить результат обратно на стек
    - **Операция**: `dataStack.push(-dataStack.pop() + dataStack.pop())`

- **Умножение**
    - **Синтаксис**: `*`
    - **Описание**: перемножить первое и второе значение со стека и положить результат обратно на стек
    - **Операция**: `dataStack.push(dataStack.pop() * dataStack.pop())`

- **Деление**
    - **Синтаксис**: `/`
    - **Описание**: разделить нацело второе значение со стека на первое и положить результат обратно на стек
    - **Операция**: `dataStack.push(1 / dataStack.pop() * dataStack.pop())`

#### Побитовые операции

- **И**
    - **Синтаксис**: `and`
    - **Описание**: выполнить побитовое `И` между двумя первыми элементами стека и положить результат обратно на стек
    - **Операция**: `dataStack.push(dataStack.pop() & dataStack.pop())`

- **ИЛИ**
    - **Синтаксис**: `or`
    - **Описание**: выполнить побитовое `ИЛИ` между двумя первыми элементами стека и положить результат обратно на стек
    - **Операция**: `dataStack.push(dataStack.pop() | dataStack.pop())`

- **ИСКЛЮЧАЮЩЕЕ ИЛИ**
    - **Синтаксис**: `^`
    - **Описание**: выполнить побитовое `ИСКЛЮЧАЮЩЕЕ ИЛИ` между двумя первыми элементами стека и положить результат обратно на стек
    - **Операция**: `dataStack.push(dataStack.pop() ^ dataStack.pop())`

- **НЕ**
    - **Синтаксис**: `not`
    - **Описание**: выполнить побитовое `НЕ` над первым элементом стека и положить результат обратно на стек
    - **Операция**: `dataStack.push(~dataStack.pop())`

#### Операции манипуляции со стеком данных

- **Дублирование**
    - **Синтаксис**: `dup`
    - **Описание**: продублировать первый элемент стека
    - **Операция**: `dataStack.push(dataStack.top())`

- **Обмен (первого и второго)**
    - **Синтаксис**: `swap`
    - **Описание**: обменять значения первых двух элементов стека
    - **Операция**: `FV <- dataStack.pop(), SV <- dataStack.pop(); dataStack.push(FV), dataStack.push(SV)`

- **Обмен (первого и третьего)**
    - **Синтаксис**: `over`
    - **Описание**: обменять значения первого и третьего элементов стека
    - **Операция**: `FV <- dataStack.pop(), SV <- dataStack.pop(), TV <- dataStack.pop(); dataStack.push(TV), dataStack.push(SV), dataStack.push(FV)`

- **Удаление**
    - **Синтаксис**: `drop`
    - **Описание**: удалить первый элемент со стека
    - **Операция**: `dataStack.pop()`

- **Полная очистка**
    - **Синтаксис**: `clearstack`
    - **Описание**: очистить полностью стек
    - **Операция**: `dataStack.pop()`

- **Вывод символа на стандартный поток вывода**
    - **Синтаксис**: `emit`
    - **Описание**: взять первый элемент со стека и передать на стандартный поток вывода
    - **Операция**: `STDOUT <- dataStack.top(); dataStack.pop()`
